# api

Api - JavaScript client for api
<!--
この文書はOpenAPIの description に埋め込まれて利用されることが想定されている。
-->

## 想定利用ケースとAPIが提供する機能

物件を広告するホームページやスマホアプリでの利用を想定した機能を提供する。
具体例として以下のような利用を想定している。

* 物件詳細画面のように単一の物件に関連する画像をまとめて取得する場合
* 物件一覧画面のように多数の物件の一部の画像(外観写真や間取り図)のサムネイルを取得する場合

これらに対応して以下の３つの機能を実装している。

* 物件を指定して、その物件に関連する画像メタデータを取得する
* 複数の物件を指定して、関連するすべての画像メタデータをまとめて取得する
* 画像ファイルを（必要ならば）縮小して取得する

## リソース補足

### 画像種別（kind）について

画像を特定するための情報。
1つの物件に紐づく画像の中では画像種別はユニークになっており、
いい物件Oneで画像を登録したときの「登録位置」に応じて決まる。

賃貸物件（rent）と売買物件（sale）で共通の画像種別が用いられる。
ただし、どちらかにしか用いられない画像種別も存在する。

具体的な画像種別と対応するコード値は以下の表の通りである。
連番の部分については「〜」で省略されている。

| kind | kind_code | rent | sale |
| :--- | :-------- | :--- | :--- |
| 間取り | 1 | ○ | |
| 玄関 | 2 | ○ | |
| リビング | 3 | ○ | |
| キッチン | 4 | ○ | |
| ベッドルーム | 5 | ○ | |
| ベッドルーム | 6 | ○ | |
| ベランダ | 7 | ○ | |
| レインズ用チラシ画像 | 8 | ○ | ○ |
| チラシ | 9 | ○ | ○ |
| 外観 | 10 | ○ | ○ |
| 地図 | 11 | ○ | |
| ランドマーク | 12 | ○ | |
| その他内観画像1～6 | 13〜18 | ○ | |
| その他外観画像1～6 | 19〜24 | ○ | |
| その他内観画像7～42 | 25〜60 | ○ | |
| 建物パノラマ画像1～5 | p1〜p5 | ○ | ○ |
| 区画パノラマ画像1～5 | p6〜p10 | ○ | ○ |
| 周辺施設画像1～ | i1〜 | ○ | ○ |
| 売主コメント1～ | u1〜 | | ○ |
| 構造・設備1～ | k1〜 | | ○ |
| その他画像 | 99 | | ○ |

### 画像カテゴリー（category）について

補助的な画像についての情報。
賃貸物件、売買物件、周辺施設画像の計３グループが存在する。
画像カテゴリーがnullのこともある。

#### 賃貸物件（rent）の category 一覧

```text
間取り、玄関、リビング、キッチン、ベッドルーム、風呂画像、ベランダ、レインズ用チラシ画像、チラシ、外観、地図、その他、エントランス、ロビー、駐車場、その他共有部分、その他部屋・スペース、トイレ、洗面所、収納、庭、セキュリティ、その他設備、眺望、内装、子供部屋、地図（共通）、ダイニング、洋室、和室、ロフト、屋上、倉庫、周辺環境
```

#### 売買物件（sale）の category 一覧

```text
間取図・土地図、現地写真、内観写真（その他）、同仕様写真（外観）、同仕様写真（その他内観）、完成予想図（外観）、完成予想図（内観）、眺望写真、造成完了予想図、建物プラン例（その他）、共用部写真（その他）、現地写真（庭）、現地写真（玄関）、現地写真（バルコニー）、現地写真（駐車場）、現地写真（前面道路含む現地写真）、現地写真（その他）、モデルルーム写真、モデルハウス写真、展示場／ショウルーム、内観写真（リビング）、内観写真（浴室）、内観写真（キッチン）、内観写真（リビング以外の居室）、内観写真（トイレ）、内観写真（洗面台・洗面所）、内観写真（収納）、共用部写真（エントランス）、共用部写真（ロビー）、共用部写真（駐車場）、区画図、土地図＋建物プラン例、分譲済街並み写真、航空写真、高台写真、同仕様写真（リビング）、同仕様写真（浴室）、同仕様写真（キッチン）、街並完成予想図、建物プラン例（外観写真）、建物プラン例（内観写真）、建物プラン例（パース・外観）、建物プラン例（パース・内観）、建物プラン例（間取り図）、その他、全体区画図、現地案内図、交通アクセス図、路線図、内観写真（内装）、内観写真（子供部屋）、内観写真（寝室）、設備、発電・温水設備、冷暖房・空調設備、防犯設備、その他設備、構造・工法・仕様、駅、公園、高校・高専、中学校、小学校、幼稚園・保育園、スーパー、周辺の街並み、ショッピングセンター、コンビニ、ドラッグストア、ホームセンター、病院、郵便局、役所、図書館、銀行、警察署・交番、その他環境写真、ベッドルーム、ダイニング、洋室、和室、ロフト、屋上、倉庫
```

#### 画像種別（kind）が周辺施設画像のときの category 一覧

```text
総合病院、内科、小児科、小学校、中学校、幼稚園、保育所、公園、スーパー、コンビ二、ショッピング施設、公共施設、海または川、高速道路入り口、コインランドリー、ランドマーク、郵便局、銀行、レストラン、その他、ドラッグストア、ホームセンター、高校・高専、役所、図書館、警察署・交番、駅、周辺の街並み、商店街、歯科、大学・短大、専門学校、インターチェンジ
```

###  媒体コード（baitai_code）について

「媒体」とはいい物件Oneからデータを出向する先のサービスの総称である。
具体的にはSUUMO賃貸やレインズ売買、貴社HP等を指す。

いい物件Oneでは、媒体毎に画像を出稿する/しないを制限することができる。

画像を登録した直後は全媒体に出稿する状態になっている。
その状態から、画像毎に出稿禁止の設定ができる。
パノラマ画像を登録した直後は出稿しない媒体も存在するような設定になっている。

いい物件Oneで画像出稿禁止に設定されていた場合、画像メタデータ取得時にサーバでフィルターされることがある。
具体的に指定するコード値については別途補足資料参照。

## コンテンツの更新タイミング

当APIではコンテンツキャッシュ（CDN）を利用している。

いい物件Oneで募集画像を更新してから当APIのレスポンスに反映されるまでにはタイムラグが存在し、
画像メタデータの取得は最大10分程度、画像データの取得は長期にわたって更新されないことがある。

画像メタデータに含まれる画像URL（ `url` ）は画像の更新に追従して URL を更新する仕組みがある。
画像URLを直接埋め込むのではなく、
画像メタデータを取得してから画像URLを動的に埋め込むことでキャシュを回避する使い方が想定されている。

## オリジン間リソース共有 (CORS)

* ブラウザ上で稼働する JavaScript から呼び出し可能で、SPAでも利用可能
* preflight 用に OPTIONS を許可
* 基本的に `Access-Control-Allow-Origin: *` で応答するため、どのドメインからでも利用可能

This SDK is automatically generated by the [OpenAPI Generator](https://openapi-generator.tech) project:

- API version: 2.1.0
- Package version: 2.1.0
- Build package: org.openapitools.codegen.languages.JavascriptClientCodegen

## Installation

### For [Node.js](https://nodejs.org/)

#### npm

To publish the library as a [npm](https://www.npmjs.com/), please follow the procedure in ["Publishing npm packages"](https://docs.npmjs.com/getting-started/publishing-npm-packages).

Then install it via:

```shell
npm install api --save
```

Finally, you need to build the module:

```shell
npm run build
```

##### Local development

To use the library locally without publishing to a remote npm registry, first install the dependencies by changing into the directory containing `package.json` (and this README). Let's call this `JAVASCRIPT_CLIENT_DIR`. Then run:

```shell
npm install
```

Next, [link](https://docs.npmjs.com/cli/link) it globally in npm with the following, also from `JAVASCRIPT_CLIENT_DIR`:

```shell
npm link
```

To use the link you just defined in your project, switch to the directory you want to use your api from, and run:

```shell
npm link /path/to/<JAVASCRIPT_CLIENT_DIR>
```

Finally, you need to build the module:

```shell
npm run build
```

#### git

If the library is hosted at a git repository, e.g.https://github.com/GIT_USER_ID/GIT_REPO_ID
then install it via:

```shell
    npm install GIT_USER_ID/GIT_REPO_ID --save
```

### For browser

The library also works in the browser environment via npm and [browserify](http://browserify.org/). After following
the above steps with Node.js and installing browserify with `npm install -g browserify`,
perform the following (assuming *main.js* is your entry file):

```shell
browserify main.js > bundle.js
```

Then include *bundle.js* in the HTML pages.

### Webpack Configuration

Using Webpack you may encounter the following error: "Module not found: Error:
Cannot resolve module", most certainly you should disable AMD loader. Add/merge
the following section to your webpack config:

```javascript
module: {
  rules: [
    {
      parser: {
        amd: false
      }
    }
  ]
}
```

## Getting Started

Please follow the [installation](#installation) instruction and execute the following JS code:

```javascript
var Api = require('api');


var api = new Api.ImageQueryAPIApi()
var propertyKey = 2113026781900000000002,2113026781900000000003,2113026781900000000004; // {String} いい生活番号のリスト（カンマ区切り）  いい生活番号をカンマ区切りで複数指定できる。 指定できるの個数の上限は50。 
var opts = {
  'baitaiCode': 101, // {Number} 媒体コード  いい物件One上の出稿設定でフィルターする  * 専用の媒体コードを指定する。コードの詳細は「媒体コード（baitai_code）について」参照 * 指定しなかった場合、いい物件Oneで画像の出稿先媒体を「すべて」にしている画像メタデータのみ取得する * 特にパノラマ画像はデフォルトでの出稿先媒体が「すべて」ではないので注意 * いい物件Oneで出稿先媒体を限定している場合、このパラメータで媒体を指定する必要がある * 存在しないコードが指定されてもエラーにはせず、指定されなかったときと同じ挙動になる 
  'kindCode': 1,2,3 // {String} 画像種別コード  画像種別でフィルターする  * kind_code をカンマ区切りで１つ以上指定することができる * 指定された場合、指定された画像種別のみを取得する * 指定されなかった場合、すべての画像を取得する * 存在しないコードが指定されてもエラーにならない 
};
api.bulkGetMetadataRentRentListGet(propertyKey, opts).then(function(data) {
  console.log('API called successfully. Returned data: ' + data);
}, function(error) {
  console.error(error);
});


```

## Documentation for API Endpoints

All URIs are relative to *http://localhost*

Class | Method | HTTP request | Description
------------ | ------------- | ------------- | -------------
*Api.ImageQueryAPIApi* | [**bulkGetMetadataRentRentListGet**](docs/ImageQueryAPIApi.md#bulkGetMetadataRentRentListGet) | **GET** /rent/list/ | Bulk Get Metadata Rent
*Api.ImageQueryAPIApi* | [**bulkGetMetadataSaleSaleListGet**](docs/ImageQueryAPIApi.md#bulkGetMetadataSaleSaleListGet) | **GET** /sale/list/ | Bulk Get Metadata Sale
*Api.ImageQueryAPIApi* | [**getImageRentRentImgPropertyKeyFilenameGet**](docs/ImageQueryAPIApi.md#getImageRentRentImgPropertyKeyFilenameGet) | **GET** /rent/img/{property_key}/{filename} | Get Image Rent
*Api.ImageQueryAPIApi* | [**getImageSaleSaleImgPropertyKeyFilenameGet**](docs/ImageQueryAPIApi.md#getImageSaleSaleImgPropertyKeyFilenameGet) | **GET** /sale/img/{property_key}/{filename} | Get Image Sale
*Api.ImageQueryAPIApi* | [**getMetadataRentRentPropertyKeyGet**](docs/ImageQueryAPIApi.md#getMetadataRentRentPropertyKeyGet) | **GET** /rent/{property_key}/ | Get Metadata Rent
*Api.ImageQueryAPIApi* | [**getMetadataSaleSalePropertyKeyGet**](docs/ImageQueryAPIApi.md#getMetadataSaleSalePropertyKeyGet) | **GET** /sale/{property_key}/ | Get Metadata Sale


## Documentation for Models

 - [Api.ErrorResponse](docs/ErrorResponse.md)
 - [Api.HTTPValidationError](docs/HTTPValidationError.md)
 - [Api.MetadataResponse](docs/MetadataResponse.md)
 - [Api.ValidationError](docs/ValidationError.md)


## Documentation for Authorization

All endpoints do not require authorization.
